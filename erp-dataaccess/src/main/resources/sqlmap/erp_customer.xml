<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lxzl.erp.dataaccess.dao.mysql.customer.CustomerMapper">

	<resultMap id="CustomerDO" type="com.lxzl.erp.dataaccess.domain.customer.CustomerDO">
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="customer_type" jdbcType="INTEGER" property="customerType" />
		<result column="customer_no" jdbcType="VARCHAR" property="customerNo" />
		<result column="customer_name" jdbcType="VARCHAR" property="customerName" />
		<result column="is_disabled" jdbcType="INTEGER" property="isDisabled" />
		<result column="data_status" jdbcType="INTEGER" property="dataStatus" />
		<result column="remark" jdbcType="VARCHAR" property="remark" />
		<result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="create_user" jdbcType="VARCHAR" property="createUser" />
		<result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="update_user" jdbcType="VARCHAR" property="updateUser" />

		<association resultMap="CustomerCompanyDO" property="customerCompanyDO"/>
		<association resultMap="CustomerPersonDO" property="customerPersonDO"/>
		<association resultMap="CustomerRiskManagementDO" property="customerRiskManagementDO"/>
	</resultMap>

	<resultMap id="CustomerRiskManagementDO" type="com.lxzl.erp.dataaccess.domain.customer.CustomerRiskManagementDO">
		<id column="ecrm_id" jdbcType="INTEGER" property="id" />
		<result column="ecrm_customer_id" jdbcType="INTEGER" property="customerId" />
		<result column="ecrm_credit_amount" jdbcType="DECIMAL" property="creditAmount" />
		<result column="ecrm_credit_amount_used" jdbcType="DECIMAL" property="creditAmountUsed" />
		<result column="ecrm_deposit_cycle" jdbcType="INTEGER" property="depositCycle" />
		<result column="ecrm_payment_cycle" jdbcType="INTEGER" property="paymentCycle" />
		<result column="ecrm_apple_deposit_cycle" jdbcType="INTEGER" property="appleDepositCycle" />
		<result column="ecrm_apple_payment_cycle" jdbcType="INTEGER" property="applePaymentCycle" />
		<result column="ecrm_new_deposit_cycle" jdbcType="INTEGER" property="newDepositCycle" />
		<result column="ecrm_new_payment_cycle" jdbcType="INTEGER" property="newPaymentCycle" />
		<result column="ecrm_apple_pay_mode" jdbcType="INTEGER" property="applePayMode" />
		<result column="ecrm_new_pay_mode" jdbcType="INTEGER" property="newPayMode" />
		<result column="ecrm_pay_mode" jdbcType="INTEGER" property="payMode" />
		<result column="ecrm_data_status" jdbcType="INTEGER" property="dataStatus" />
		<result column="ecrm_remark" jdbcType="VARCHAR" property="remark" />
		<result column="ecrm_create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="ecrm_create_user" jdbcType="VARCHAR" property="createUser" />
		<result column="ecrm_update_time" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="ecrm_update_user" jdbcType="VARCHAR" property="updateUser" />
	</resultMap>

	<resultMap id="CustomerCompanyDO" type="com.lxzl.erp.dataaccess.domain.customer.CustomerCompanyDO">
		<id column="ecc_id" jdbcType="INTEGER" property="id" />
		<result column="ecc_customer_id" jdbcType="INTEGER" property="customerId" />
		<result column="ecc_landline" jdbcType="VARCHAR" property="landline" />
		<result column="ecc_connect_real_name" jdbcType="VARCHAR" property="connectRealName" />
		<result column="ecc_connect_phone" jdbcType="VARCHAR" property="connectPhone" />
		<result column="ecc_company_name" jdbcType="VARCHAR" property="companyName" />
		<result column="ecc_company_abb" jdbcType="VARCHAR" property="companyAbb" />
		<result column="ecc_province" jdbcType="INTEGER" property="province" />
		<result column="ecc_city" jdbcType="INTEGER" property="city" />
		<result column="ecc_district" jdbcType="INTEGER" property="district" />
		<result column="ecc_address" jdbcType="VARCHAR" property="address" />
		<result column="ecc_legal_person" jdbcType="VARCHAR" property="legalPerson" />
		<result column="ecc_legal_person_no" jdbcType="VARCHAR" property="legalPersonNo" />
		<result column="ecc_business_license_no" jdbcType="VARCHAR" property="businessLicenseNo" />
		<result column="ecc_data_status" jdbcType="INTEGER" property="dataStatus" />
		<result column="ecc_remark" jdbcType="VARCHAR" property="remark" />
		<result column="ecc_create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="ecc_create_user" jdbcType="VARCHAR" property="createUser" />
		<result column="ecc_update_time" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="ecc_update_user" jdbcType="VARCHAR" property="updateUser" />

		<result column="provinceName" jdbcType="VARCHAR" property="provinceName" />
		<result column="cityName" jdbcType="VARCHAR" property="cityName" />
		<result column="districtName" jdbcType="VARCHAR" property="districtName" />

		<result column="ecc_customer_origin" jdbcType="INTEGER" property="customerOrigin" />
		<result column="ecc_company_found_time" jdbcType="TIMESTAMP" property="companyFoundTime" />
		<result column="ecc_industry" jdbcType="VARCHAR" property="industry" />
		<result column="ecc_registered_capital" jdbcType="INTEGER" property="registeredCapital" />
		<result column="ecc_office_number" jdbcType="INTEGER" property="officeNumber" />
		<result column="ecc_product_purpose" jdbcType="VARCHAR" property="productPurpose" />
		<result column="ecc_customer_company_need_first_json" jdbcType="VARCHAR" property="customerCompanyNeedFirstJson" />
		<result column="ecc_customer_company_need_later_json" jdbcType="VARCHAR" property="customerCompanyNeedLaterJson" />
		<result column="ecc_agent_person_name" jdbcType="VARCHAR" property="agentPersonName" />
		<result column="ecc_agent_person_phone" jdbcType="VARCHAR" property="agentPersonPhone" />
		<result column="ecc_agent_person_no" jdbcType="VARCHAR" property="agentPersonNo" />
		<result column="ecc_unified_credit_code" jdbcType="VARCHAR" property="unifiedCreditCode" />
		<result column="ecc_customer_no" jdbcType="VARCHAR" property="customerNo" />
		<result column="ecc_is_legal_person_apple" jdbcType="INTEGER" property="isLegalPersonApple" />
		<result column="ecc_legal_person_phone" jdbcType="VARCHAR" property="legalPersonPhone" />
		<result column="ecc_sales_man" jdbcType="VARCHAR" property="salesMan" />
		<result column="ecc_union_area" jdbcType="VARCHAR" property="unionArea" />
		<result column="ecc_union_sales_man" jdbcType="VARCHAR" property="unionSalesMan" />
		<result column="ecc_operating_area" jdbcType="DOUBLE" property="operatingArea" />
		<result column="ecc_unit_insured_number" jdbcType="INTEGER" property="unitInsuredNumber" />
		<result column="ecc_affiliated_enterprise" jdbcType="VARCHAR" property="affiliatedEnterprise" />

	</resultMap>
	<resultMap id="CustomerPersonDO" type="com.lxzl.erp.dataaccess.domain.customer.CustomerPersonDO">
		<id column="ecp_id" jdbcType="INTEGER" property="id" />
		<result column="ecp_customer_id" jdbcType="INTEGER" property="customerId" />
		<result column="ecp_real_name" jdbcType="VARCHAR" property="realName" />
		<result column="ecp_email" jdbcType="VARCHAR" property="email" />
		<result column="ecp_phone" jdbcType="VARCHAR" property="phone" />
		<result column="ecp_province" jdbcType="INTEGER" property="province" />
		<result column="ecp_city" jdbcType="INTEGER" property="city" />
		<result column="ecp_district" jdbcType="INTEGER" property="district" />
		<result column="ecp_address" jdbcType="VARCHAR" property="address" />
		<result column="ecp_data_status" jdbcType="INTEGER" property="dataStatus" />
		<result column="ecp_remark" jdbcType="VARCHAR" property="remark" />
		<result column="ecp_create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="ecp_create_user" jdbcType="VARCHAR" property="createUser" />
		<result column="ecp_update_time" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="ecp_update_user" jdbcType="VARCHAR" property="updateUser" />

		<result column="provinceName" jdbcType="VARCHAR" property="provinceName" />
		<result column="cityName" jdbcType="VARCHAR" property="cityName" />
		<result column="districtName" jdbcType="VARCHAR" property="districtName" />

		<result column="ecp_person_name" jdbcType="VARCHAR" property="personName" />
		<result column="ecp_person_no" jdbcType="VARCHAR" property="personNo" />
		<result column="ecp_connect_real_name" jdbcType="VARCHAR" property="connectRealName" />
		<result column="ecp_connect_phone" jdbcType="VARCHAR" property="connectPhone" />
	</resultMap>
	<sql id="column_List">
		ec.id,ec.customer_type,ec.customer_no,ec.customer_name,ec.is_disabled,ec.data_status,ec.remark,ec.create_time,ec.create_user,ec.update_time,ec.update_user
	</sql>
	<sql id="company_column_List">
		ecc.id AS ecc_id,ecc.customer_id AS ecc_customer_id,ecc.landline AS ecc_landline,ecc.connect_real_name AS ecc_connect_real_name,ecc.connect_phone AS ecc_connect_phone,ecc.company_name AS ecc_company_name,ecc.company_abb AS ecc_company_abb,ecc.province AS ecc_province,ecc.city AS ecc_city,ecc.district AS ecc_district,ecc.address AS ecc_address,ecc.legal_person AS ecc_legal_person,ecc.legal_person_no AS ecc_legal_person_no,ecc.business_license_no AS ecc_business_license_no,ecc.data_status AS ecc_data_status,ecc.remark AS ecc_remark,ecc.create_time AS ecc_create_time,ecc.create_user AS ecc_create_user,ecc.update_time AS ecc_update_time,ecc.update_user AS ecc_update_use,ecc.customer_origin AS ecc_customer_origin,ecc.company_found_time AS ecc_company_found_time,ecc.industry AS ecc_industry,ecc.registered_capital AS ecc_registered_capital,ecc.office_number AS ecc_office_number,ecc.product_purpose AS ecc_product_purpose,ecc.customer_company_need_first_json AS ecc_customer_company_need_first_json,ecc.customer_company_need_later_json AS ecc_customer_company_need_later_json,ecc.agent_person_name AS ecc_agent_person_name,ecc.agent_person_phone AS ecc_agent_person_phone,ecc.agent_person_no AS ecc_agent_person_no,ecc.unified_credit_code AS ecc_unified_credit_code,ecc.customer_no AS ecc_customer_no,ecc.is_legal_person_apple AS ecc_is_legal_person_apple,ecc.legal_person_phone AS ecc_legal_person_phone,ecc.sales_man AS ecc_sales_man,ecc.union_area AS ecc_union_area,ecc.union_sales_man AS ecc_union_sales_man,ecc.operating_area AS ecc_operating_area,ecc.unit_insured_number AS ecc_unit_insured_number,ecc.affiliated_enterprise AS ecc_affiliated_enterprise
	</sql>
	<sql id="person_column_List">
		ecp.id AS ecp_id,ecp.customer_id AS ecp_customer_id,ecp.real_name AS ecp_real_name,ecp.email AS ecp_email,ecp.phone AS ecp_phone,ecp.province AS ecp_province,ecp.city AS ecp_city,ecp.district AS ecp_district,ecp.address AS ecp_address,ecp.data_status AS ecp_data_status,ecp.remark AS ecp_remark,ecp.create_time AS ecp_create_time,ecp.create_user AS ecp_create_user,ecp.update_time AS ecp_update_time,ecp.update_user AS ecp_update_user,ecp.person_name AS ecp_person_name, ecp.person_no AS ecp_person_no, ecp.connect_real_name AS ecp_connect_real_name, ecp.connect_phone AS ecp_connect_phone

	</sql>
	<sql id="risk_column_List">
		ecrm.id AS ecrm_id,ecrm.customer_id AS ecrm_customer_id,ecrm.credit_amount AS ecrm_credit_amount,ecrm.credit_amount_used AS ecrm_credit_amount_used,ecrm.deposit_cycle AS ecrm_deposit_cycle,ecrm.payment_cycle AS ecrm_payment_cycle,ecrm.apple_deposit_cycle AS ecrm_apple_deposit_cycle,ecrm.apple_payment_cycle AS ecrm_apple_payment_cycle,ecrm.new_deposit_cycle AS ecrm_new_deposit_cycle,ecrm.new_payment_cycle AS ecrm_new_payment_cycle,ecrm.apple_pay_mode AS ecrm_apple_pay_mode,ecrm.new_pay_mode AS ecrm_new_pay_mode,ecrm.pay_mode AS ecrm_pay_mode,ecrm.data_status AS ecrm_data_status,ecrm.remark AS ecrm_remark,ecrm.create_time AS ecrm_create_time,ecrm.create_user AS ecrm_create_user,ecrm.update_time AS ecrm_update_time,ecrm.update_user AS ecrm_update_user
	</sql>
	<select id="findById" resultMap="CustomerDO" parameterType="java.lang.Integer">
		SELECT <include refid="column_List"/>,<include refid="risk_column_List"/> FROM erp_customer ec
		LEFT JOIN erp_customer_risk_management ecrm on ecrm.customer_id = ec.id and ecrm.data_status=1
		WHERE ec.id = #{id, jdbcType=INTEGER} AND ec.data_status = 1 
	</select>
	<select id="findByNo" resultMap="CustomerDO" parameterType="java.lang.String">
		SELECT <include refid="column_List"/>,<include refid="risk_column_List"/> FROM erp_customer ec
		LEFT JOIN erp_customer_risk_management ecrm on ecrm.customer_id = ec.id and ecrm.data_status=1
		WHERE ec.customer_no = #{customerNo, jdbcType=VARCHAR} AND ec.data_status = 1
	</select>
	<select id="findCustomerCompanyByNo" resultMap="CustomerDO" parameterType="java.lang.String">
		SELECT <include refid="column_List"/>,<include refid="company_column_List"/>,<include refid="risk_column_List"/>
		,eap.province_name AS provinceName
		,eac.city_name AS cityName
		,ead.district_name AS districtName
		FROM erp_customer ec
		LEFT JOIN erp_customer_company ecc ON ec.id=ecc.customer_id AND ec.customer_type=1 AND ecc.data_status=1
		LEFT JOIN erp_area_province eap ON ecc.province=eap.id AND eap.data_status=1
		LEFT JOIN erp_area_city eac ON ecc.city=eac.id AND eac.data_status=1
		LEFT JOIN erp_area_district ead ON ecc.district=ead.id AND ead.data_status=1
		LEFT JOIN erp_customer_risk_management ecrm on ecrm.customer_id = ec.id AND ecrm.data_status=1
		WHERE ec.customer_no = #{customerNo, jdbcType=VARCHAR} AND ec.data_status = 1
	</select>
	<select id="findCustomerPersonByNo" resultMap="CustomerDO" parameterType="java.lang.String">
		SELECT <include refid="column_List"/>,<include refid="person_column_List"/>,<include refid="risk_column_List"/>,eap.province_name AS provinceName
		,eac.city_name AS cityName
		,ead.district_name AS districtName
		FROM erp_customer ec
		LEFT JOIN erp_customer_person ecp ON ec.id=ecp.customer_id AND ec.customer_type=2 AND ecp.data_status=1
		LEFT JOIN erp_area_province eap ON ecp.province=eap.id AND eap.data_status=1
		LEFT JOIN erp_area_city eac ON ecp.city=eac.id AND eac.data_status=1
		LEFT JOIN erp_area_district ead ON ecp.district=ead.id AND ead.data_status=1
		LEFT JOIN erp_customer_risk_management ecrm on ecrm.customer_id = ec.id AND ecrm.data_status=1
		WHERE ec.customer_no = #{customerNo, jdbcType=VARCHAR} AND ec.data_status = 1
	</select>

	<select id="listCount" resultType="java.lang.Integer" parameterType="map">
		SELECT count(ec.id) FROM erp_customer ec 
		<where>
			<if test="maps.productEquipmentQueryParam.createStartTime != null ">
				<![CDATA[ AND ec.create_time >= #{maps.productEquipmentQueryParam.createStartTime} ]]>
			</if>
			<if test="maps.productEquipmentQueryParam.createEndTime != null">
				<![CDATA[ AND ec.create_time <= #{maps.productEquipmentQueryParam.createEndTime} ]]>
			</if>
			<if test="true">
				AND ec.data_status = 1
			</if>
		</where>
	</select>

	<select id="listPage" resultMap="CustomerDO" parameterType="map">
		SELECT <include refid="column_List"/> FROM erp_customer ec 
		<where>
			<if test="true">
				AND ec.data_status = 1
			</if>
		</where>
		LIMIT #{maps.start},#{maps.pageSize}
	</select>

	<sql id="set_column_sql">
		<set>
			<if test="customerType != null">
				customer_type = #{customerType,jdbcType=INTEGER},
			</if>
			<if test="customerNo != null">
				customer_no = #{customerNo,jdbcType=VARCHAR},
			</if>
			<if test="customerName != null">
				customer_name = #{customerName,jdbcType=VARCHAR},
			</if>
			<if test="isDisabled != null">
				is_disabled = #{isDisabled,jdbcType=INTEGER},
			</if>
			<if test="dataStatus != null">
				data_status = #{dataStatus,jdbcType=INTEGER},
			</if>
			<if test="remark != null">
				remark = #{remark,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="createUser != null">
				create_user = #{createUser,jdbcType=VARCHAR},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="updateUser != null">
				update_user = #{updateUser,jdbcType=VARCHAR},
			</if>
		</set>
	</sql>

	<insert id="save" keyProperty="id" useGeneratedKeys="true" parameterType="com.lxzl.erp.dataaccess.domain.customer.CustomerDO">
		INSERT INTO erp_customer <include refid="set_column_sql"/>
	</insert>

	<update id="update" parameterType="com.lxzl.erp.dataaccess.domain.customer.CustomerDO">
		UPDATE erp_customer <include refid="set_column_sql"/> WHERE id = #{id, jdbcType=INTEGER}
	</update>
	<select id="findCustomerCompanyCountByParams" resultType="Integer" parameterType="map">

		SELECT COUNT(*) FROM erp_customer ec LEFT JOIN erp_customer_company ecc ON ec.id=ecc.customer_id AND ecc.data_status = 1
		<where>
			<if test="maps.queryParam.customerNo != null &amp;&amp; maps.queryParam.customerNo != ''">
				AND ec.customer_no LIKE CONCAT('%','${maps.queryParam.customerNo}','%' )
			</if>
			<if test="maps.queryParam.connectRealName != null &amp;&amp; maps.queryParam.connectRealName != ''">
				AND ecc.connect_real_name LIKE CONCAT('%','${maps.queryParam.connectRealName}','%' )
			</if>
			<if test="maps.queryParam.connectPhone != null &amp;&amp; maps.queryParam.connectPhone != ''">
				AND ecc.connect_phone LIKE CONCAT('%','${maps.queryParam.connectPhone}','%' )
			</if>
			<if test="maps.queryParam.companyName != null &amp;&amp; maps.queryParam.companyName != ''">
				AND ecc.company_name LIKE CONCAT('%','${maps.queryParam.companyName}','%' )
			</if>
			<if test="maps.queryParam.province != null">
				AND ecc.province = #{maps.queryParam.province, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.city != null">
				AND ecc.city = #{maps.queryParam.city, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.district != null">
				AND ecc.district = #{maps.queryParam.district, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.legalPerson != null &amp;&amp; maps.queryParam.legalPerson != ''">
				AND ecc.legal_person LIKE CONCAT('%','${maps.queryParam.legalPerson}',jdbcType=VARCHAR )
			</if>
			<if test="maps.queryParam.legalPersonNo != null &amp;&amp; maps.queryParam.legalPersonNo != ''">
				AND ecc.legal_person_no = #{maps.queryParam.legalPersonNo, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.businessLicenseNo != null &amp;&amp; maps.queryParam.businessLicenseNo != ''">
				AND ecc.business_license_no = #{maps.queryParam.businessLicenseNo, jdbcType=VARCHAR}
			</if>
			<if test="true">
				AND ec.data_status = 1 AND ec.customer_type=1
			</if>
		</where>
		ORDER BY ec.create_time DESC

	</select>
	<select id="findCustomerCompanyByParams" resultMap="CustomerDO" parameterType="map">

		SELECT <include refid="column_List"/>,<include refid="company_column_List"/>
		,eap.province_name AS provinceName
		,eac.city_name AS cityName
		,ead.district_name AS districtName
		FROM erp_customer ec LEFT JOIN erp_customer_company ecc on ec.id=ecc.customer_id and ecc.data_status = 1
		LEFT JOIN erp_area_province eap ON ecc.province=eap.id AND eap.data_status=1
		LEFT JOIN erp_area_city eac ON ecc.city=eac.id AND eac.data_status=1
		LEFT JOIN erp_area_district ead ON ecc.district=ead.id AND ead.data_status=1
		<where>
			<if test="maps.queryParam.customerNo != null &amp;&amp; maps.queryParam.customerNo != ''">
				and ec.customer_no LIKE CONCAT('%','${maps.queryParam.customerNo}','%' )
			</if>
			<if test="maps.queryParam.connectRealName != null &amp;&amp; maps.queryParam.connectRealName != ''">
				and ecc.connect_real_name LIKE CONCAT('%','${maps.queryParam.connectRealName}','%' )
			</if>
			<if test="maps.queryParam.connectPhone != null &amp;&amp; maps.queryParam.connectPhone != ''">
				and ecc.connect_phone LIKE CONCAT('%','${maps.queryParam.connectPhone}','%' )
			</if>
			<if test="maps.queryParam.companyName != null &amp;&amp; maps.queryParam.companyName != ''">
				AND ecc.company_name LIKE CONCAT('%','${maps.queryParam.companyName}','%' )
			</if>
			<if test="maps.queryParam.province != null">
				AND ecc.province = #{maps.queryParam.province, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.city != null">
				AND ecc.city = #{maps.queryParam.city, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.district != null">
				AND ecc.district = #{maps.queryParam.district, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.legalPerson != null &amp;&amp; maps.queryParam.legalPerson != ''">
				AND ecc.legal_person LIKE CONCAT('%','${maps.queryParam.legalPerson}','%' )
			</if>
			<if test="maps.queryParam.legalPersonNo != null &amp;&amp; maps.queryParam.legalPersonNo != ''">
				AND ecc.legal_person_no = #{maps.queryParam.legalPersonNo, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.businessLicenseNo != null &amp;&amp; maps.queryParam.businessLicenseNo != ''">
				AND ecc.business_license_no = #{maps.queryParam.businessLicenseNo, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.industry != null &amp;&amp; maps.queryParam.industry != ''">
				and ecc.industry like CONCAT('%','${maps.queryParam.industry}','%' )
			</if>
			<if test="maps.queryParam.productPurpose != null &amp;&amp; maps.queryParam.productPurpose != ''">
				and ecc.product_purpose like CONCAT('%','${maps.queryParam.productPurpose}','%' )
			</if>
			<if test="maps.queryParam.officeNumber != null">
				and ecc.office_number = #{maps.queryParam.officeNumber, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.agentPersonName != null &amp;&amp; maps.queryParam.agentPersonName != ''">
				and ecc.agent_person_name like CONCAT('%','${maps.queryParam.agentPersonName}','%' )
			</if>
			<if test="maps.queryParam.agentPersonPhone != null &amp;&amp; maps.queryParam.agentPersonPhone != ''">
				and ecc.agent_person_phone = #{maps.queryParam.agentPersonPhone, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.agentPersonNo != null &amp;&amp; maps.queryParam.agentPersonNo != ''">
				and ecc.agent_person_no = #{maps.queryParam.agentPersonNo, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.unifiedCreditCode != null &amp;&amp; maps.queryParam.unifiedCreditCode != ''">
				and ecc.unified_credit_code = #{maps.queryParam.unifiedCreditCode, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.salesMan != null &amp;&amp; maps.queryParam.salesMan != ''">
				and ecc.sales_man like CONCAT('%','${maps.queryParam.salesMan}','%' )
			</if>
			<if test="maps.queryParam.unionArea != null &amp;&amp; maps.queryParam.unionArea != ''">
				and ecc.union_area = #{maps.queryParam.unionArea, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.unionSalesMan != null &amp;&amp; maps.queryParam.unionSalesMan != ''">
				and ecc.union_sales_man = #{maps.queryParam.unionSalesMan, jdbcType=VARCHAR}
			</if>
			<if test="maps.queryParam.affiliatedEnterprise != null &amp;&amp; maps.queryParam.affiliatedEnterprise != ''">
				and ecc.affiliated_enterprise = #{maps.queryParam.affiliatedEnterprise, jdbcType=VARCHAR}
			</if>
			<if test="true">
				AND ec.data_status = 1 AND ec.customer_type=1
			</if>
		</where>
		ORDER BY ec.create_time DESC
		LIMIT #{maps.start},#{maps.pageSize}

	</select>

	<select id="findCustomerPersonCountByParams" resultType="java.lang.Integer" parameterType="map">
		SELECT COUNT(*)
		FROM erp_customer ec LEFT JOIN erp_customer_person ecp ON ec.id=ecp.customer_id AND ecp.data_status=1
		<where>
			<if test="maps.queryParam.customerNo != null &amp;&amp; maps.queryParam.customerNo != ''">
				AND ec.customer_no LIKE CONCAT('%','${maps.queryParam.customerNo}','%' )
			</if>
			<if test="maps.queryParam.realName != null &amp;&amp; maps.queryParam.realName != null">
				AND ecp.real_name LIKE CONCAT('%','${maps.queryParam.realName}','%' )
			</if>
			<if test="maps.queryParam.phone != null &amp;&amp; maps.queryParam.phone != ''">
				AND ecp.phone LIKE CONCAT('%','${maps.queryParam.phone}','%' )
			</if>
			<if test="maps.queryParam.province != null">
				AND ecp.province = #{maps.queryParam.province, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.city != null">
				AND ecp.city = #{maps.queryParam.city, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.district != null">
				AND ecp.district = #{maps.queryParam.district, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.personName != null &amp;&amp; maps.queryParam.personName != ''">
				AND ecp.personName LIKE CONCAT('%','${maps.queryParam.personName}','%' )
			</if>
			<if test="maps.queryParam.personNo != null &amp;&amp; maps.queryParam.personNo != ''">
				AND ecp.personNo LIKE CONCAT('%','${maps.queryParam.personNo}','%' )
			</if>
			<if test="maps.queryParam.connectRealName != null &amp;&amp; maps.queryParam.connectRealName != ''">
				AND ecp.connectRealName LIKE CONCAT('%','${maps.queryParam.connectRealName}','%' )
			</if>
			<if test="maps.queryParam.connectPhone != null &amp;&amp; maps.queryParam.connectPhone != ''">
				AND ecp.connectPhone LIKE CONCAT('%','${maps.queryParam.connectPhone}','%' )
			</if>
			<if test="true">
				AND ec.data_status = 1 AND ec.customer_type=2
			</if>
		</where>
	</select>
	<select id="findCustomerPersonByParams" resultMap="CustomerDO" parameterType="map">

		SELECT <include refid="column_List"/>,<include refid="person_column_List"/>
		,eap.province_name AS provinceName
		,eac.city_name AS cityName
		,ead.district_name AS districtName
		FROM erp_customer ec LEFT JOIN erp_customer_person ecp ON ec.id=ecp.customer_id AND ecp.data_status=1
		LEFT JOIN erp_area_province eap ON ecp.province=eap.id AND eap.data_status=1
		LEFT JOIN erp_area_city eac ON ecp.city=eac.id AND eac.data_status=1
		LEFT JOIN erp_area_district ead ON ecp.district=ead.id AND ead.data_status=1
		<where>
			<if test="maps.queryParam.customerNo != null &amp;&amp; maps.queryParam.customerNo != ''">
				AND ec.customer_no LIKE CONCAT('%','${maps.queryParam.customerNo}','%' )
			</if>
			<if test="maps.queryParam.realName != null &amp;&amp; maps.queryParam.realName != null">
				AND ecp.real_name LIKE CONCAT('%','${maps.queryParam.realName}','%' )
			</if>
			<if test="maps.queryParam.phone != null &amp;&amp; maps.queryParam.phone != ''">
				AND ecp.phone LIKE CONCAT('%','${maps.queryParam.phone}','%' )
			</if>
			<if test="maps.queryParam.province != null">
				AND ecp.province = #{maps.queryParam.province, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.city != null">
				AND ecp.city = #{maps.queryParam.city, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.district != null">
				AND ecp.district = #{maps.queryParam.district, jdbcType=INTEGER}
			</if>
			<if test="maps.queryParam.personName != null &amp;&amp; maps.queryParam.personName != ''">
				AND ecp.personName LIKE CONCAT('%','${maps.queryParam.personName}','%' )
			</if>
			<if test="maps.queryParam.personNo != null &amp;&amp; maps.queryParam.personNo != ''">
				AND ecp.personNo LIKE CONCAT('%','${maps.queryParam.personNo}','%' )
			</if>
			<if test="maps.queryParam.connectRealName != null &amp;&amp; maps.queryParam.connectRealName != ''">
				AND ecp.connectRealName LIKE CONCAT('%','${maps.queryParam.connectRealName}','%' )
			</if>
			<if test="maps.queryParam.connectPhone != null &amp;&amp; maps.queryParam.connectPhone != ''">
				AND ecp.connectPhone LIKE CONCAT('%','${maps.queryParam.connectPhone}','%' )
			</if>
			<if test="true">
				AND ec.data_status = 1 AND ec.customer_type=2
			</if>
		</where>
		ORDER BY ec.create_time DESC
		LIMIT #{maps.start},#{maps.pageSize}

	</select>
</mapper>